---
import BaseLayout from "@/layouts/BaseLayout.astro";
---

<BaseLayout 
  title="Рефрижераторы на базе LADA Granta ВИС и LADA Largus — под ключ | Izotermvan"
  description="Готовые рефрижераторы с изотермическим фургоном и ХОУ. Под температурный режим фармы, мяса, молочки, цветов. Доставка по РФ."
>

  <!-- HERO -->
  <section class="grid gap-10 md:grid-cols-2 md:items-start">
    <div class="grid gap-6">
      <h1 class="text-3xl font-semibold tracking-tight md:text-5xl leading-tight">
        Рефрижераторы на базе LADA Granta ВИС и LADA Largus — под ключ
      </h1>

      <p class="text-slate-700 md:text-lg">
        Изотермический фургон нужной толщины, 
        <strong>холодильно-отопительная установка (ХОУ)</strong> под ваш температурный режим, 
        дооснащение под задачи бизнеса. Доставка по всей РФ.
      </p>

      <div class="flex flex-wrap gap-3">
        <a href="/contacts#lead"
           class="rounded-xl bg-slate-900 px-5 py-3 text-sm font-medium text-white hover:bg-slate-800">
          Получить расчёт за 15 минут
        </a>

        <a href="/models"
           class="rounded-xl border border-slate-200 px-5 py-3 text-sm font-medium hover:bg-slate-50">
          Подобрать модель
        </a>
      </div>

      <div class="grid gap-2 pt-4 text-sm text-slate-600">
        <div>✓ Температурные режимы: фарма / мясо / молочка / цветы</div>
        <div>✓ Доп. опции: пневмоподвеска, стеллажи, GPS, камеры, 2DIN, кондиционер</div>
        <div>✓ Центральный, Приволжский и Уральский регионы — приоритет</div>
      </div>
    </div>

    <!-- Форма-заглушка -->
        <!-- Форма -->
    <div class="rounded-2xl border border-slate-200 p-6 shadow-sm">
      <h2 class="text-lg font-semibold">Получить расчёт</h2>
      <p class="mt-2 text-sm text-slate-600">
        Подберём базу, толщину фургона и ХОУ под ваш температурный режим.
      </p>

      <form id="leadForm" class="mt-5 grid gap-3">
        <label class="grid gap-1 text-sm">
          <span class="text-slate-700">Телефон *</span>
          <input
            class="rounded-xl border px-3 py-2 text-sm"
            name="phone"
            inputmode="tel"
            autocomplete="tel"
            placeholder="8 800 700-68-14 или +7..."
            required
          />
          <span id="phoneHelp" class="hidden text-xs text-rose-600">
            Укажите телефон: минимум 10 цифр.
          </span>
        </label>

        <label class="grid gap-1 text-sm">
          <span class="text-slate-700">База</span>
          <select class="rounded-xl border px-3 py-2 text-sm" name="base">
            <option value="">Выберите базу</option>
            <option>LADA Granta ВИС</option>
            <option>LADA Largus</option>
            <option>Нужна консультация</option>
          </select>
        </label>

        <label class="grid gap-1 text-sm">
          <span class="text-slate-700">Температурный режим</span>
          <select class="rounded-xl border px-3 py-2 text-sm" name="temp">
            <option value="">Выберите режим</option>
            <option>+2…+8 °C (фарма)</option>
            <option>-18 °C (заморозка)</option>
            <option>0…+5 °C (продукты)</option>
            <option>Индивидуальный</option>
          </select>
        </label>

        <label class="grid gap-1 text-sm">
          <span class="text-slate-700">Комментарий</span>
          <textarea
            class="min-h-24 rounded-xl border px-3 py-2 text-sm"
            name="comment"
            placeholder="Например: толщина стенок, опции (пневма/стеллажи/GPS/камеры/кондиционер), город доставки"
          ></textarea>
        </label>

        <button
          id="leadBtn"
          class="rounded-xl bg-slate-900 px-4 py-2 text-sm font-medium text-white hover:bg-slate-800 disabled:cursor-not-allowed disabled:opacity-60"
          type="submit"
        >
          Получить расчёт
        </button>

        <!-- Сообщения вместо alert -->
        <div id="leadMsg" class="hidden rounded-xl border px-3 py-2 text-sm"></div>

        <p class="text-xs text-slate-500">
          Нажимая кнопку, вы соглашаетесь с <a class="underline" href="/privacy">политикой обработки данных</a>.
        </p>
      </form>
    </div>

  </section>

  <!-- ДЛЯ КОГО -->
  <section class="mt-20">
    <h2 class="text-2xl font-semibold tracking-tight">Кому подходит</h2>

    <div class="mt-8 grid gap-4 md:grid-cols-3">
      {[
        "Фарма и медицинская продукция",
        "Мясо, полуфабрикаты, молочная продукция",
        "Фермерские хозяйства",
        "Кафе, рестораны, кондитерские",
        "Цветочные доставки",
        "Поставщики продуктов из РБ",
        "Отели и собственные кухни",
        "Производства при религиозных организациях"
      ].map((item) => (
        <div class="rounded-2xl border border-slate-200 p-5 text-sm text-slate-700">
          {item}
        </div>
      ))}
    </div>
  </section>

  <!-- ОПЦИИ -->
  <section class="mt-20">
    <h2 class="text-2xl font-semibold tracking-tight">Комплектация и дооснащение</h2>

    <div class="mt-8 grid gap-6 md:grid-cols-3">
      <div class="rounded-2xl border p-6">
        <h3 class="font-semibold">Изотермический фургон</h3>
        <p class="mt-2 text-sm text-slate-600">
          Разная толщина стенок под температурный режим и требования бизнеса.
        </p>
      </div>

      <div class="rounded-2xl border p-6">
        <h3 class="font-semibold">Холодильно-отопительная установка (ХОУ)</h3>
        <p class="mt-2 text-sm text-slate-600">
          Подбор под диапазон температур и условия эксплуатации.
        </p>
      </div>

      <div class="rounded-2xl border p-6">
        <h3 class="font-semibold">Дополнительные опции</h3>
        <p class="mt-2 text-sm text-slate-600">
          Пневмоподвеска, стеллажи, сигнализация с GPS и автозапуском,
          камеры заднего вида, 2DIN магнитола, кондиционер салона.
        </p>
      </div>
    </div>
  </section>
    <!-- ПОЧЕМУ НАМ ДОВЕРЯЮТ -->
  <section class="mt-20">
    <h2 class="text-2xl font-semibold tracking-tight">
      Почему нам доверяют
    </h2>

    <div class="mt-10 grid gap-6 md:grid-cols-3">
      
      <div class="rounded-2xl border border-slate-200 p-6">
        <div class="text-4xl font-semibold">700+</div>
        <div class="mt-2 text-sm text-slate-600">
          Выполненных авторефрижераторов различных моделей
        </div>
      </div>

      <div class="rounded-2xl border border-slate-200 p-6">
        <div class="text-4xl font-semibold">10 лет</div>
        <div class="mt-2 text-sm text-slate-600">
          Опыт в переоборудовании коммерческого транспорта
        </div>
      </div>

      <div class="rounded-2xl border border-slate-200 p-6">
        <div class="text-4xl font-semibold">от 10 дней</div>
        <div class="mt-2 text-sm text-slate-600">
          Срок изготовления автомобиля под ключ
        </div>
      </div>

      <div class="rounded-2xl border border-slate-200 p-6">
        <div class="text-4xl font-semibold">1 год / 100 000 км</div>
        <div class="mt-2 text-sm text-slate-600">
          Гарантия на переоборудование
        </div>
      </div>

      <div class="rounded-2xl border border-slate-200 p-6">
        <div class="text-4xl font-semibold">Вся РФ</div>
        <div class="mt-2 text-sm text-slate-600">
          Поставки от Калининграда до Благовещенска
        </div>
      </div>

      <div class="rounded-2xl border border-slate-200 p-6">
        <div class="text-4xl font-semibold">8-800-700-68-14</div>
        <div class="mt-2 text-sm text-slate-600">
          Горячая линия поддержки и сервисная сеть по всей России
        </div>
      </div>

    </div>
  </section>
  <!-- КАК МЫ РАБОТАЕМ -->
  <section class="mt-20">
    <h2 class="text-2xl font-semibold tracking-tight">
      Как мы работаем
    </h2>

    <div class="mt-10 grid gap-6 md:grid-cols-5">
      
      <div class="text-sm text-slate-700">
        <div class="font-semibold">1. Заявка</div>
        <p class="mt-2">
          Вы оставляете заявку или звоните на горячую линию.
        </p>
      </div>

      <div class="text-sm text-slate-700">
        <div class="font-semibold">2. Подбор решения</div>
        <p class="mt-2">
          Определяем базу, толщину фургона и ХОУ под температурный режим.
        </p>
      </div>

      <div class="text-sm text-slate-700">
        <div class="font-semibold">3. Договор</div>
        <p class="mt-2">
          Фиксируем комплектацию, сроки и условия поставки.
        </p>
      </div>

      <div class="text-sm text-slate-700">
        <div class="font-semibold">4. Производство</div>
        <p class="mt-2">
          Переоборудование и установка всех дополнительных опций.
        </p>
      </div>

      <div class="text-sm text-slate-700">
        <div class="font-semibold">5. Выдача и поддержка</div>
        <p class="mt-2">
          Передача автомобиля и сервисная поддержка по всей РФ.
        </p>
      </div>

    </div>
  </section>


  <!-- CTA НИЖНИЙ -->
  <section class="mt-20 rounded-2xl bg-slate-900 p-10 text-white">
    <h2 class="text-2xl font-semibold">
      Подберём автомобиль под ваш бизнес и температурный режим
    </h2>

    <p class="mt-3 text-sm text-slate-300">
      Консультация бесплатная. Доставка по РФ.
    </p>

    <a href="/contacts#lead"
       class="mt-6 inline-block rounded-xl bg-white px-5 py-3 text-sm font-medium text-slate-900 hover:bg-slate-100">
      Оставить заявку
    </a>
  </section>
<script>
  const form = document.getElementById("leadForm");
  const msg = document.getElementById("leadMsg");
  const btn = document.getElementById("leadBtn");
  const phoneHelp = document.getElementById("phoneHelp");

  function setMsg(kind, text) {
    // kind: "ok" | "err"
    msg.className =
      "rounded-xl border px-3 py-2 text-sm " +
      (kind === "ok"
        ? "border-emerald-200 bg-emerald-50 text-emerald-800"
        : "border-rose-200 bg-rose-50 text-rose-800");
    msg.textContent = text;
    msg.classList.remove("hidden");
  }

  function normalizeDigits(s) {
    return (s || "").replace(/\D/g, "");
  }

  function isValidPhone(s) {
    const d = normalizeDigits(s);
    // РФ телефоны обычно 10–11 цифр. Берём минимум 10 — чтобы не резать 8-800 и городские варианты.
    return d.length >= 10;
  }

  if (form) {
    form.addEventListener("submit", async (e) => {
      e.preventDefault();
      msg.classList.add("hidden");
      phoneHelp.classList.add("hidden");

      const phone = form.elements.phone.value.trim();
      const base = form.elements.base.value;
      const temp = form.elements.temp.value;
      const comment = form.elements.comment.value.trim();

      if (!isValidPhone(phone)) {
        phoneHelp.classList.remove("hidden");
        setMsg("err", "Проверьте номер телефона: минимум 10 цифр.");
        return;
      }

      btn.disabled = true;
      const oldBtn = btn.textContent;
      btn.textContent = "Отправляем…";

      try {
        const res = await fetch("/api/lead", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({
            phone,
            base,
            temp,
            comment,
            // метки:
            pagePath: window.location.pathname,
            pageUrl: window.location.href,
            referrer: document.referrer || "",
            utm: Object.fromEntries(new URLSearchParams(window.location.search)),
          }),
        });

        const text = await res.text();
        let json = null;
        try { json = text ? JSON.parse(text) : null; } catch {}

        if (!res.ok || (json && json.ok === false)) {
          setMsg("err", "Не удалось отправить заявку. Попробуйте ещё раз или позвоните 8-800-700-68-14.");
          return;
        }

        setMsg("ok", "Заявка отправлена. Мы свяжемся с вами в ближайшее время.");
        form.reset();
      } catch (err) {
        console.error(err);
        setMsg("err", "Ошибка соединения. Попробуйте ещё раз или позвоните 8-800-700-68-14.");
      } finally {
        btn.disabled = false;
        btn.textContent = oldBtn;
      }
    });
  }
</script>



</BaseLayout>
